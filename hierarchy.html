<!DOCTYPE html>
<html>
<head>
    <!-- leaflet + stamen maps -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
    <script type="text/javascript" src="http://maps.stamen.com/js/tile.stamen.js?v1.2.4"></script>
    <script src="ngeohash.js"></script>
    <style type="text/css">
        #map {
            position: absolute; left: 0px; top: 0px; width: 600px; height: 426px;
        }

    </style>
</head>
<body>
<div id="map">

</div>
<script type="text/javascript">
    (function(){
        var ngeohash = require('ngeohash');

        console.dir(ngeohash);

        var singapore = {
            geohash: 'w21zf0bce',
            lat_lon: [1.3667, 103.8000]
        };

        var geohashes = [
            'w21zf0bce',
            'w21zf0bc',
            'w21zf0b',
            'w21zf0',
            'w21zf',
            'w21z',
            'w21',
            'w2',
            'w'];

        var layer = new L.StamenTileLayer("toner");
        var map = new L.Map("map", {
            center: new L.LatLng(0, 0),
            zoom: 1,
            zoomControl: true
        });
        map.addLayer(layer);

        var count = 0;
        var showNext = function() {
            if (count < geohashes.length) {
                var geohash = geohashes[count];
                console.log(geohash);

                var bbox = ngeohash.decode_bbox(geohash);
                var minlat = bbox[0];
                var minlon = bbox[1];
                var maxlat = bbox[2];
                var maxlon = bbox[3];

                var southWest = L.latLng(minlat, minlon);
                var northEast = L.latLng(maxlat, maxlon);
                var bounds = L.latLngBounds(southWest, northEast);

                L.rectangle(bounds, {color: "#ff7800", weight: 1}).addTo(map);

                map.fitBounds(bounds);

                count++;
            }
        };

        setInterval(showNext, 3000);

        L.marker(singapore.lat_lon).addTo(map);
    })();
</script>
</body>
</html>